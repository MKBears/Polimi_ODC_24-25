from pwn import xor

payload1 = [
0x29,
0x2F,
0x17,
0x40,
0x7,
0x2D,
0xB6,
0x28,
0xA7,
0x14,
0x38,
0x9A,
0xD9,
0xB2,
0x0E,
0x8,
0xF1,
0x2,
0x6B,
0xD0,
0x1A,
0x9,
0xE1,
0x1D,
0x20,
0x17,
0xAC,
0x2E,
0xCB,
0xA8,
0xA9,
0x57,
0x5F,
0x9,
0xFE,
0x9D,
0x41,
0x66,
0x41,
0xD5,
0x89,
0xC5,
0xB3,
0x5A,
0x8E,
0xA1,
0x8B,
0xD2,
0x4,
0x3C,
0xF7,
0xCF,
0x2A,
0x11,
0x0D,
0xA9,
0x51,
0x8D,
0x85,
0x7B,
0x9,
0xD4,
0x31,
0xC3,
0xF4,
0x2E,
0x56,
0xEB,
0x64,
0x22,
0xD6,
0x9,
0xFD,
0xD2,
0x19,
0x86,
0x22,
0x2,
0xAD,
0xB4,
0x9C,
0xE8,
0x62,
0xB5,
0x6C,
0xFA,
0xA2,
0xBB,
0x79,
0x80,
0x2,
0xB5,
0x0D,
0x4,
0x8,
0x2A,
0xC7,
0x7C,
0xB8,
0xC6,
0x6,
0x98,
0x52,
0x89,
0x23,
0xA0,
0x9D,
0x6B,
0x69,
0x33,
0xFD,
0x84,
0x3A,
0x8C,
0xBC,
0xE1,
0x8B,
0x40,
0xCE,
0x29,
0x33,
0xE6,
0xE7,
0xFD,
0x8F,
0xDC,
0xA1,
0xC8,
0xDA,
0xD9,
0x5D,
0x5D,
0x15,
0xDA,
0x89,
0xCD,
0xB8,
0x66,
0xD5,
0xD3,
0x85,
0x3C,
0xA5,
0x72,
0x8,
0x1,
0x43,
0x50,
0xBD,
0x59,
0xC8,
0x18,
0x47,
0xF4,
0xC6,
0x6B,
0x0A,
0xF3,
0xA4,
0x19,
0x74,
0x8E,
0xE3,
0x59,
0x3F,
0xE4,
0x96,
0x94,
0xA4,
0x79,
0x42,
0xF0,
0xDA,
0x26,
0x1F,
0xEB,
0x10,
0xE1,
0x0C,
0xE5,
0x5E,
0xEA,
0xCC,
0xAE,
0xC3,
0x88,
0xAE,
0xE5,
0x7E,
0x28,
0x89,
0x4C,
0x5E,
0xD7,
0xE5,
0xBE,
0xCC,
0xFD,
0xD5,
0xF5,
0x86,
0x35,
0x74,
0x97,
0x92,
0xD8,
0x25,
0x19,
0x1B,
0x33,
0xAA,
0x3E,
0xE4,
0xF0,
0xB8,
0x1,
0xDC,
0xC2,
0xD9,
0x58,
0x6A,
0xCD,
0xCD,
0x8D,
0xCA,
0xB1,
0x8E,
0xAA,
0x10,
0x40,
0xC6,
0x98,
0x0,
0x0,
0x0,
0x0,
0x0,
0x0,
0x0,
0x0
]

unknown = [
0x7041B0934D1B2555, 
0x0BA924D5FE60DD842, 
0x8D3F142F3D3D68CF,
0x6E86A537EDB8D812, 
0x5BEF7F3D91A7CB27, 
0x703D1C29B0230044,
0x0CB1C081C4307E69F, 
0x0FA07CD641149E641, 
0x0F80CF3293D69F7E0,
0x5390E8C82D3F3231, 
0x0C032236A20DDBF44, 
0x30E7DF291ED1519D,
0x0ECF7C862177A397F, 
0x6343F56ED13C60DA, 
0x0A71457CA9AF45612,
0x0BEE3A07D2DDEAC9D, 
0x0EDBCB32608A0AD76, 
0x0D80A0E5386D245B5,
0x0E5831B534F5CE000, 
0x572D80B303A994C5, 
0x0BF88C59A8E72C39E,
0x0AE21BAF6964B089B, 
0x9FE08F69563FFE6F, 
0x0C2B826AD9969F20A,
0x93CA1B2E4DA45F45, 
0x2CC4B82094F095BC, 
0x0C24EF9BD3E717F01,
0x4586AE8579C84E4F, 
0x0B77466497E419C97, 
0x0B7A4BC0E47A0EE91,
0x0BD8CC568355A3B47, 
0x0BA9F104200A438C1, 
0x0A1F2EE48C7CFA857
]

key = b"_YARE_YARE_DAZE_"
dec = b''

rax = [0x988a215bec73afb4, 0xedba58208b12c3d2]
rdx = [0xef48e5cb65f245cf, 0x9c1791b3569c1abd]

print(xor(rax[0].to_bytes(8, "little") + xor(rax[1].to_bytes(8, "little"), key)))
print(xor(rdx[0].to_bytes(8, "little") + xor(rdx[1].to_bytes(8, "little"), key)))

print(xor(rax[1].to_bytes(8, "little") + xor(rax[0].to_bytes(8, "little"), key)))
print(xor(rdx[1].to_bytes(8, "little") + xor(rdx[0].to_bytes(8, "little"), key)))

print(xor(rax[0].to_bytes(8, "little") + xor(rdx[0].to_bytes(8, "little"), key)))
print(xor(rax[1].to_bytes(8, "little") + xor(rdx[1].to_bytes(8, "little"), key)))

# for i in range(240) :
#     p = payload1[i:i+0x10]
#     dec += xor(p, key, 0x10)
#     i += 0x10

# print(dec)

# for i in range(len(unknown)/2) :
#     data = unknown[i].to_bytes(8, "little") + unknown[i+1].to_bytes(8, "little")
#     res = xor(data, key, 0x10)
#     print(res)
#     i += 2

# with open("payload1", "wb") as f:
#     f.write(dec)